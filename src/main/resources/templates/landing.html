<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script src="https://kit.fontawesome.com/04d7bae26f.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" th:href="@{/css/styleLanding.css}" type="text/css" />
    <title>Blogosphere - Home</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>


    <script>
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const searchParam = urlParams.get('search');

            const displayElement = document.getElementById('searchDisplay');

            if (!searchParam) {
                displayElement.innerHTML = '<p>recent blogs with various topics</p>';
            } else {
                displayElement.innerHTML = '<p>recent posts with the topic: ' + searchParam + '</p>';

                const postElement = document.getElementById('blog');

                if (postElement) {
                    postElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }
        };

        document.addEventListener('DOMContentLoaded', function () {
            var navbarToggle = document.querySelector('.navbar-toggle');
            var navbarNav = document.querySelector('.navbar-nav');

            navbarToggle.addEventListener('click', function () {
                navbarNav.style.maxHeight = navbarNav.style.maxHeight ? null : navbarNav.scrollHeight + 'px';
            });
        });
    </script>
    </head>

<body>
    <header>
        <nav class="navbar">
            <div class="container">
                <a th:href="@{/}" class="navbar-brand">Blogosphere</a>
                <i class="fa-solid fa-bars navbar-toggle"></i>
                <div class="navbar-nav">
                    <a th:href="@{/}">Home</a>
                    <a th:href="@{/post/my}">Posts</a>
                    <a th:href="@{/post/upload}">Add Post</a>
                    <a th:href="@{/login}" sec:authorize="!hasRole('EMPLOYEE')">Sign In</a>
                    <form action="#" sec:authorize="hasRole('EMPLOYEE')" th:action="@{/logout}"
                        method="POST">
                        <button type="submit" class="nav-btn" >LOGOUT</button>
                    </form>
                    <a th:href="@{/admin}" sec:authorize="hasRole('ADMIN')">Admin Panel</a>
                </div>
            </div>
        </nav>

        <div class="banner">
            <div class="container">
                <h1 class="banner-title">
                    <span>Blog</span> osphere
                </h1>
                <p>Unleash creativity and explore the boundless universe of ideas</p>
                <form action="#" th:action="@{/}" method="post" class="nav-form">
                    <input type="text" class="search-input" name="search" id="search" placeholder="Search . . .">
                    <button type="submit" class="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </form>
            </div>
        </div>
    </header>

    <section class="blog" id="blog">
        <div class="container">
            <div class="title">
                <h2>Latest Blogs</h2>
                <div id="searchDisplay" ></div>
            </div>
            <div class="blog-content" th:style="${#lists.isEmpty(posts)} ? 'grid-template-columns: repeat(1, 1fr);' : ''">
                <div th:if="${#lists.isEmpty(posts)}">
                    <h1>No posts available</h1>
                </div>
                <div th:else class="blog-item" th:each="post : ${posts}" th:if="${post.privacy == 'public'}"    >
                        <span th:text="${#dates.format(post.date, 'dd MMMM, yyyy')}"></span>
                        <h2 th:text="${post.title}"></h2>
                        <p th:text="'by ' + ${post.user.getUserName()}"></p>
                        <p th:text="${post.description}"></p>
                        <a th:href="@{/post/note(postId=${post.id})}">Read More</a>
                </div>
            </div>
        </div>
    </section>

    <section class="about" id="about">
        <div class="container">
            <div class="about-content">
                <div class="title">
                    <h2>dasd dasdfw</h2>
                    <p>art & deisgn is my passion</p>
                </div>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            </div>
        </div>
    </section>

    <footer>
        <div class="social-links">
            <a href="#">
                <i class='fab fa-facebook-f'></i>
            </a>
            <a href="#">
                <i class='fab fa-twitter' ></i>
            </a>
            <a href="#">
                <i class='fab fa-instagram' ></i>
            </a>
            <a href="">
                <i class='fab fa-youtube' ></i>
            </a>
        </div>
        <span>Blogosphere Website</span>
    </footer>
</body>
</html>